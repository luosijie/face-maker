{"version":3,"sources":["webpack:///./src/components/playboard.mpx?115f","webpack:///./src/components/playboard.mpx","webpack:///./src/components/playboard.mpx?0e87","webpack:///./src/components/playboard.mpx?f257","webpack:///./src/components/playboard.mpx?0b8c","webpack:///./src/store/index.js","webpack:///./src/assets/images/example.jpeg"],"names":["store","createStore","state","ctx","eles","mutations","setCtx","data","setEles"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACyI;;AAEzI;AACA,mBAAO,CAAC,GAAgb;;AAExb;AACA,mBAAO,CAAC,GAA4P;;AAEpQ;AACA,mBAAO,CAAC,GAAsb;;;;;;;;;;;ACI9b;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA,UADA;AAEA;AAFA;AADA,GADA;AAOA;AACA;AACA;AACA;;AAHA,GAPA;AAYA;AACA;AACA;AACA;AACA;AACA,KALA;;AAMA;AACA;AACA;AACA;AACA;AACA;AACA,KAZA;;AAaA;AACA;AACA,KAfA;;AAgBA;AACA;AACA,8BACA,MADA,CACA;AAAA;AAAA;AAAA,OADA,EAEA,IAFA,CAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA,4BARA,CAUA;;AACA;AACA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SARA;AASA,OAxBA;AAyBA;;AA3CA,GAZA;;AAyDA;AACA;AACA;;AA3DA,G;;;;;;;ACnBA,uB;;;;;;;ACAA,uB;;;;;;;ACAA,uB;;;;;;;;ACAA;AAAA;AAAA;AAEA,IAAMA,KAAK,GAAGC,+DAAW,CAAC;AACxBC,OAAK,EAAE;AACLC,OAAG,EAAE,IADA;AAELC,QAAI,EAAE;AAFD,GADiB;AAKxBC,WAAS,EAAE;AACTC,UAAM,CAAEJ,KAAF,EAASK,IAAT,EAAe;AACnBL,WAAK,CAACC,GAAN,GAAYI,IAAZ;AACD,KAHQ;;AAITC,WAAO,CAAEN,KAAF,EAASK,IAAT,EAAe;AACpBL,WAAK,CAACE,IAAN,GAAaG,IAAb;AACD;;AANQ;AALa,CAAD,CAAzB;AAeeP,oEAAf,E;;;;;;;ACjBA,iBAAiB,qBAAuB,sD","file":"components/playboard5295a42f/playboard.js","sourcesContent":["global.currentModuleId\n/* script */\nexport * from \"!!babel-loader!../../node_modules/@mpxjs/webpack-plugin/lib/selector?type=script&index=0!./playboard.mpx?packageName=main\"\n\n/* styles */\nrequire(\"!!../../node_modules/@mpxjs/webpack-plugin/lib/extractor?type=styles&index=0!../../node_modules/@mpxjs/webpack-plugin/lib/wxss/loader?sourceMap&root=&importLoaders=1&extract=true!../../node_modules/@mpxjs/webpack-plugin/lib/style-compiler/index?{\\\"moduleId\\\":\\\"maaae044e\\\",\\\"scoped\\\":false,\\\"sourceMap\\\":true}!stylus-loader!../../node_modules/@mpxjs/webpack-plugin/lib/selector?type=styles&index=0!./playboard.mpx?packageName=main\")\n\n/* json */\nrequire(\"!!../../node_modules/@mpxjs/webpack-plugin/lib/extractor?type=json&index=0!../../node_modules/@mpxjs/webpack-plugin/lib/json-compiler/index?root=!../../node_modules/@mpxjs/webpack-plugin/lib/selector?type=json&index=0!./playboard.mpx?packageName=main\")\n\n/* template */\nrequire(\"!!../../node_modules/@mpxjs/webpack-plugin/lib/extractor?type=template&index=0!../../node_modules/@mpxjs/webpack-plugin/lib/wxml/wxml-loader?root=!../../node_modules/@mpxjs/webpack-plugin/lib/template-compiler/index?{\\\"usingComponents\\\":[],\\\"hasScoped\\\":false,\\\"isNative\\\":false,\\\"moduleId\\\":\\\"maaae044e\\\",\\\"projectRoot\\\":\\\"\\\"}!../../node_modules/@mpxjs/webpack-plugin/lib/selector?type=template&index=0!./playboard.mpx?packageName=main\")\n\n","<template>\n  <view class=\"playboard\">\n    <image class=\"icon-add\" src=\"../assets/images/icon-add-image.png\" alt=\"添加图片\"/>\n    <canvas\n      type=\"2d\"\n      id=\"canvas\"\n      class=\"canvas\"\n      bindtouchstart=\"touchstart\"\n      bindtouchmove=\"touchmove\"\n      bindtouchend=\"touchend\"\n    />\n  </view>\n</template>\n\n<script>\n  import { createComponent } from '@mpxjs/core'\n  import store from '../store'\n  import example from '../assets/images/example.jpeg'\n\n  createComponent({\n    data: {\n      startPos: {\n        x: 0,\n        y: 0\n      }\n    },\n    computed: {\n      ctx () {\n        return store.state.ctx\n      }\n    },\n    methods: {\n      touchstart (e) {\n        this.startPos.x = e.touches[0].x\n        this.startPos.y = e.touches[0].y\n        console.log('touch-start', e, this.startPos)\n      },\n      touchmove (e) {\n        this.ctx.clearRect(0, 0, this.ctx.canvas.width, this.ctx.canvas.height)\n        const x = e.touches[0].x\n        const y = e.touches[0].y\n        console.log('touch-move', this.startPos.x, this.startPos.y)\n        this.ctx.fillRect(this.startPos.x, this.startPos.y, x - this.startPos.x, y - this.startPos.y)\n      },\n      touchend (e) {\n        console.log('touch-end', e)\n      },\n      initCanvas () {\n        const query = this.createSelectorQuery()\n        query.select('#canvas')\n          .fields({ node: true, size: true })\n          .exec((res) => {\n            const canvas = res[0].node\n            const ctx = canvas.getContext('2d')\n            store.commit('setCtx', ctx)\n\n            const dpr = wx.getSystemInfoSync().pixelRatio\n            canvas.width = res[0].width * dpr\n            canvas.height = res[0].height * dpr\n            ctx.scale(dpr, dpr)\n\n            // \b初始化一张背景图\n            const img = canvas.createImage()\n            img.src = example\n            img.onload = e => {\n              // console.log('img loaded', e.path[0].width. e.pa)\n              const cWidth = canvas.width / dpr\n              const cHeight = canvas.height / dpr\n              const rate = e.path[0].height / cHeight\n              const width = e.path[0].width / rate\n              const left = (cWidth - width) / 2\n              ctx.drawImage(img, left, 0, width, cHeight)\n            }\n          })\n      }\n    },\n    ready () {\n      this.initCanvas()\n    }\n  })\n</script>\n\n<style lang=\"stylus\">\n  .playboard\n    position relative\n    width 100vw\n    height 100vw\n    background #f8f8f8\n\n  .canvas \n    width 100vw\n    height 100vw\n  \n  .icon-add \n    position absolute\n    width 160rpx\n    height 160rpx\n    left 50%\n    top 50%\n    margin-top -80rpx\n    margin-left -80rpx\n</style>\n\n<script type=\"application/json\">\n  {\n    \"component\": true\n  }\n</script>\n","// removed by extractor","// removed by extractor","// removed by extractor","import { createStore } from '@mpxjs/core'\n\nconst store = createStore({\n  state: {\n    ctx: null,\n    eles: []\n  },\n  mutations: {\n    setCtx (state, data) {\n      state.ctx = data\n    },\n    setEles (state, data) {\n      state.eles = data\n    }\n  }\n})\n\nexport default store\n","module.exports = __webpack_public_path__ + \"img/example73295048bd4260075333211267a0584d.jpeg\";"],"sourceRoot":""}